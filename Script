local Players = game:GetService("Players")

-- Function to create a movable HUD
local function createHUD(player)
    local playerGui = player:FindFirstChildOfClass("PlayerGui") or player:WaitForChild("PlayerGui")

    -- Create ScreenGui
    local gui = Instance.new("ScreenGui")
    gui.Name = "ObjectLister"
    gui.Parent = playerGui

    -- Create main frame (movable)
    local mainFrame = Instance.new("Frame")
    mainFrame.Size = UDim2.new(0.3, 0, 0.6, 0)
    mainFrame.Position = UDim2.new(0.02, 0, 0.2, 0)
    mainFrame.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
    mainFrame.BackgroundTransparency = 0.5
    mainFrame.BorderSizePixel = 2
    mainFrame.Parent = gui
    mainFrame.Active = true
    mainFrame.Draggable = true -- Makes it movable

    -- Create scrolling frame for object list
    local scrollingFrame = Instance.new("ScrollingFrame")
    scrollingFrame.Size = UDim2.new(1, 0, 1, -30)
    scrollingFrame.Position = UDim2.new(0, 0, 0, 30)
    scrollingFrame.BackgroundTransparency = 1
    scrollingFrame.Parent = mainFrame
    scrollingFrame.CanvasSize = UDim2.new(0, 0, 2, 0)

    -- UI List Layout for ordered object display
    local listLayout = Instance.new("UIListLayout")
    listLayout.Parent = scrollingFrame
    listLayout.SortOrder = Enum.SortOrder.LayoutOrder

    -- Create title bar for dragging
    local titleBar = Instance.new("TextLabel")
    titleBar.Size = UDim2.new(1, 0, 0, 30)
    titleBar.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
    titleBar.TextColor3 = Color3.fromRGB(255, 255, 255)
    titleBar.Text = "Object List"
    titleBar.Font = Enum.Font.SourceSansBold
    titleBar.TextSize = 18
    titleBar.Parent = mainFrame

    return scrollingFrame
end

-- Function to list all objects inside the UI
local function listAllObjects(parent, uiParent, indent)
    indent = indent or 0

    for _, obj in pairs(parent:GetChildren()) do
        local label = Instance.new("TextLabel")
        label.Size = UDim2.new(1, 0, 0, 20)
        label.BackgroundTransparency = 1
        label.TextColor3 = Color3.fromRGB(255, 255, 255)
        label.Text = string.rep("   ", indent) .. "- " .. obj.Name .. " (" .. obj.ClassName .. ")"
        label.TextXAlignment = Enum.TextXAlignment.Left
        label.Parent = uiParent

        listAllObjects(obj, uiParent, indent + 1) -- Recursively list children
    end
end

-- When a player joins, create the HUD and list all objects
Players.PlayerAdded:Connect(function(player)
    player.CharacterAdded:Connect(function()
        wait(1) -- Give time for PlayerGui to load
        local ui = createHUD(player)
        listAllObjects(game, ui)
    end)
end)
